{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\model\\sys_role.js"
    ],
    "names": [
        "module",
        "exports",
        "think",
        "Model",
        "addData",
        "param",
        "menuids",
        "create_date",
        "datetime",
        "del_flag",
        "id",
        "uuid",
        "add",
        "list",
        "i",
        "length",
        "menu",
        "push",
        "role_id",
        "menu_id",
        "model",
        "addMany",
        "delData",
        "where",
        "delete",
        "updateData",
        "update_date",
        "update",
        "pageData",
        "_sql",
        "sql",
        "alias",
        "join",
        "table",
        "as",
        "on",
        "page",
        "current",
        "order",
        "isEmpty",
        "name",
        "data",
        "countSelect",
        "allData",
        "select",
        "getData",
        "find"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\model\\sys_role.js",
    "sourcesContent": [
        "'use strict';\n\nmodule.exports = class extends think.Model {\n\n\tasync addData(param){\n\t\tlet menuids=param.menuids;\n\t\tparam.create_date=think.datetime();\n\t\tparam.del_flag=0;\n\t\tparam.id=think.uuid('v1');\n\t\tdelete param.menuids;\n\t\tawait this.add(param);\n\t\tlet list=[];\n\t\tif(menuids){\n\t\t\tfor(var i=0;i<menuids.length;i++){\n\t\t\t\tlet menu=menuids[i];\n\t\t\t\tlist.push({role_id:param.id,menu_id:menu});\t\t\t\n\t\t\t}\n\t\t}\t\t\n\t\tif(list.length>0){\n\t\t\tawait this.model('sys_role_menu').addMany(list);\n\t\t}\n\t}\n\n\n\tasync delData(param){\n\t\tawait this.where({id:param.id}).delete();\n\t\tawait this.model('sys_role_menu').where({role_id: param.id}).delete(); // 删除菜单节点中的权限\n\t}\n\n\tasync updateData(param){\n\t\tlet id=param.id;\n\t\tlet menuids=param.menuids;\n\t\tparam.update_date=think.datetime();\n\t\tdelete param.id;\n\t\tdelete param.create_date;\n\t\tdelete param.menuids;\n\t\tawait this.where({id:id}).update(param);\n\t\tawait this.model('sys_role_menu').where({role_id: id}).delete();\n\t\tlet list=[];\n\t\tif(menuids){\n\t\t\tfor(var i=0;i<menuids.length;i++){\n\t\t\t\tlet menu=menuids[i];\n\t\t\t\tlist.push({role_id:id,menu_id:menu});\t\t\t\n\t\t\t}\n\t\t}\n\t\tif(list.length>0){\n\t\t\tawait this.model('sys_role_menu').addMany(list);\n\t\t}\n\t}\n\n\tasync pageData(param){\n\t\tlet _sql = 'select role_id,GROUP_CONCAT(menu_id) as role_menus from sys_role_menu  GROUP BY role_id';//await this.model('sys_role_menu').field(\"role_id,GROUP_CONCAT(menu_id)\").group('role_id').buildSql();\n\t\tlet sql=this.alias('a').join({\n\t      table: _sql,\n\t      as: 'b',\n\t      on: ['id', 'role_id']\n\t    }).page(param.current).order(\"create_date desc\");\n\t\tif(!think.isEmpty(param.name)){\n\t\t\tsql=sql.where({'a.name':['like', '%'+param.name+'%']});\n\t\t}\n\t\tlet data = await sql.countSelect();\n\t\treturn data;\n\t}\n\n\tasync allData(param){\n\t\tlet data=await this.where({del_flag:0}).select();\n\t\treturn data;\n\t}\n\n\tasync getData(id){\n\t\treturn await this.where({id: id}).find();\n\t}\n};\n"
    ]
}